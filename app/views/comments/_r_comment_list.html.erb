<div class="media-body" style="margin-top: 30px">
  <ul class="media-list">
    <%r_comments = comment.r_comments %>
    <% users = User.where(id: r_comments.map(&:user_id))%>
    <% r_comments.each do |r_comment| %>
      <li class="media reply_li">
        <% user = users.select{|u| u.id == r_comment.user_id}.first %>
        <%= link_to (image_tag user.logo_url(:medium), class: 'img-thumbnail media-object', size: '72x80'), 'user_profile', class: 'pull-left'%>
          <p class="media-heading">
            <%= link_to user.name, 'user_profile', style: 'padding: 5px;'%>
            <span style="font-size: 12px;"><%= distance_of_time_in_words_to_now(r_comment.created_at)%></span>
            <p class="pull-right">
              <% if @current_user.present? and @current_user == user%>
                <%= link_to '删除', 'javascript:;', class: 'deleteComment', 'data-reply_to_comment_id' => "#{r_comment.id}"%>
              <%else%>
                <%= link_to '回复', 'javascript:;', class: 'replyToComment', 'data-user_name' => "#{user.name}", 'data-reply_to_user_id' => "#{user.id}", 'data-reply_to_comment_id' => "#{r_comment.id}"%>
              <% end -%>
            </p>
          </p>
          <%= r_comment.content.html_safe %>
      </li>
    <% end -%>
  </ul>
  <% if @current_user %>
    <div class="media reply_box" style="display:none">
      <div class="col-md-2">
        <%= image_tag @current_user.logo_url(:medium), class: 'pull-right img-thumbnail', size: '72x80'%>
      </div>
      <div class="col-md-10" >
        <%= text_area_tag :content, '', class: 'form-control', rows: '4'%>
        <%= link_to '回复', 'javascript:;', class: 'btn green pull-right postCommentBtn', style: 'margin-top: 5px', 'data-p_comment_id' => comment.id%>
      </div>
    </div>
  <% end -%>
</div>
